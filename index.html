<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photo-sphere-viewer@4/dist/photo-sphere-viewer.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photo-sphere-viewer@4/dist/plugins/markers.css"/>

    <link rel="stylesheet" href="css/egg.css"/>

    <script src="https://cdn.jsdelivr.net/npm/three/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uevent@2/browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/photo-sphere-viewer@4/dist/photo-sphere-viewer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/photo-sphere-viewer@4/dist/plugins/markers.js"></script>

    <script src="js/egg.js"></script>
</head>
<body>
    <div id="startup">
        <div id="instructions">
            <p>The instructions you wish to provide go here.</p>
            <p>You can also place additional HTML to format the look of the instructions</p>
            <span id="ok" onclick="closeInstructions();">OK</span>
        </div>
    </div>

    <div id="egg-modal" class="modal">
        <div id="egg-content" class="modal-content">
            <img id="egg-img" src="images/egg1.png">
            <div id="egg-msg" class="modal-msg"></div>
        </div>
    </div>
    
    <div id="basket-modal" class="modal">
        <div id="basket-content" class="modal-content">
            <img id="basket-img" src="images/basket.png">
            <div id="basket-msg" class="modal-msg"></div>
        </div>
    </div>

    <div id="movement-modal" class="modal">
        <div id="movement-content" class="modal-content">
            <img id="movement-img" src="images/map-picnic.jpg">
        </div>
    </div>

    <div id="viewer"></div>

    <div class="controls">
        <div id="info" class="control" onclick="openInfo();">
            <img src="images/info.png">
        </div>
        <div id="basket" class="control" onclick="checkBasket();">
            <img src="images/basket.png">
        </div>
        <div id="map" class="control" onclick="loadMap();">
            <img src="images/location-162102_1280.png">
        </div>
        <div id="reset" class="control" onclick="resetHunt();">
            <img src="images/reset.png">
        </div>
    </div>
      
    <script>
        var viewer = new PhotoSphereViewer.Viewer({
          container: document.querySelector('#viewer'),
          panorama: 'images/courtyard.jpg',
          panoData: {
            fullWidth: 14440,
            fullHeight: 7220,
            croppedWidth: 14440,
            croppedHeight: 3299,
            croppedX: 0,
            croppedY: 1961,
            poseHeading: 0, // 0 to 360
            posePitch: 0, // -90 to 90
            poseRoll: 0, // -180 to 180
          },
          plugins: [
            [PhotoSphereViewer.MarkersPlugin, {}]
          ]
        });

        const markersPlugin = viewer.getPlugin(PhotoSphereViewer.MarkersPlugin);

        viewer.on('dblclick', function(e, data){
          registerClick(data, markersPlugin);
        });

        viewer.on('click', function(data){
            closeModal(data);
        });

        viewer.on('panorama-loaded', function() {
            closeMovement();
        });

        var nextLoc = 'picnic';

        function loadMap() {
            openMovement(nextLoc);

            changePanorama(nextLoc, viewer, markersPlugin);

            if(nextLoc == 'picnic') {
                nextLoc = 'courtyard';
            } else {
                nextLoc = 'picnic'
            }
        }
    </script>
</body>
</html>